<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å˜ä¾¡ç¢ºèªã‚¢ãƒ—ãƒª</title>
    <style>
        /* ã‚¹ã‚¿ã‚¤ãƒ«ã¯ç°¡ç•¥åŒ–ã—ã¦ã„ã¾ã™ */
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f4f4f4; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); }
        h1 { text-align: center; color: #333; }
        .question { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 6px; background-color: #fff; }
        label { display: block; margin-bottom: 8px; font-weight: bold; }
        input[type="number"], select, textarea { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #5cb85c; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px; width: 100%; font-size: 16px; }
        button:hover { background-color: #4cae4c; }
        .hidden { display: none; }
        #results { margin-top: 30px; padding: 20px; border: 2px solid #333; border-radius: 6px; background-color: #e9e9e9; }
        .error { color: red; font-weight: bold; margin-top: 10px; }
        /* æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .back-button { background-color: #f0ad4e; margin-top: 20px; }
        .back-button:hover { background-color: #ec971f; }
    </style>
</head>
<body>
    <div class="container">
        <div id="quiz-area">
            <h1>å˜ä¾¡ç¢ºèªã‚¢ãƒ—ãƒª</h1>
            
            <div id="q1" class="question">
                <label for="price">Q1: ãŠå®¢æ§˜ã®åŸºæœ¬å˜ä¾¡ï¼ˆç¨æŠœã€å††ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</label>
                <input type="number" id="price" placeholder="ä¾‹: 10000">
                <button onclick="nextStep(2)">æ¬¡ã¸</button>
            </div>

            <div id="q2" class="question hidden">
                <label for="contractType">Q2: å¥‘ç´„å½¢æ…‹ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</label>
                <select id="contractType">
                    <option value="freelance">ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ï¼ˆæ¥­å‹™å§”è¨—ï¼‰</option>
                    <option value="employee">æ­£ç¤¾å“¡ï¼ˆæ´¾é£ï¼‰</option>
                </select>
                <button class="back-button" onclick="prevStep(1)">æˆ»ã‚‹</button>
                <button onclick="nextStep(3)">æ¬¡ã¸</button>
            </div>

            <div id="q3" class="question hidden">
                <label for="workingHours">Q3: æœˆé–“ã®ç¨¼åƒæ™‚é–“ï¼ˆæƒ³å®šï¼‰ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</label>
                <select id="workingHours">
                    <option value="standard">æ¨™æº–ï¼ˆ160æ™‚é–“ã€œ180æ™‚é–“ï¼‰</option>
                    <option value="short">çŸ­æ™‚é–“ï¼ˆ140æ™‚é–“ä»¥ä¸‹ï¼‰</option>
                    <option value="long">é•·æ™‚é–“ï¼ˆ180æ™‚é–“è¶…ï¼‰</option>
                </select>
                <button class="back-button" onclick="prevStep(2)">æˆ»ã‚‹</button>
                <button onclick="nextStep(4)">æ¬¡ã¸</button>
            </div>

            <div id="q4" class="question hidden">
                <label for="experience">Q4: ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦ã®çµŒé¨“å¹´æ•°ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</label>
                <select id="experience">
                    <option value="junior">1å¹´æœªæº€ï¼ˆæœªçµŒé¨“å«ã‚€ï¼‰</option>
                    <option value="mid">1å¹´ã€œ3å¹´</option>
                    <option value="senior">3å¹´ä»¥ä¸Š</option>
                </select>
                <button class="back-button" onclick="prevStep(3)">æˆ»ã‚‹</button>
                <button onclick="nextStep(5)">æ¬¡ã¸</button>
            </div>
            
            <div id="q5" class="question hidden">
                <label for="skillLevel">Q5: æ±‚ã‚ã‚‰ã‚Œã‚‹ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</label>
                <select id="skillLevel">
                    <option value="basic">åŸºæœ¬çš„ãªé–‹ç™ºçµŒé¨“</option>
                    <option value="advanced">ç‰¹å®šã®æŠ€è¡“ã«ç‰¹åŒ–ã—ãŸå°‚é–€æ€§</option>
                    <option value="lead">ãƒãƒ¼ãƒ ãƒªãƒ¼ãƒ‰ã‚„è¨­è¨ˆèƒ½åŠ›</option>
                </select>
                <button class="back-button" onclick="prevStep(4)">æˆ»ã‚‹</button>
                <button onclick="nextStep(6)">æ¬¡ã¸</button>
            </div>

            <div id="q6" class="question hidden">
                <label for="location">Q6: å‹¤å‹™åœ°ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</label>
                <select id="location">
                    <option value="tokyo">æ±äº¬ï¼ˆéƒ½å¿ƒéƒ¨ï¼‰</option>
                    <option value="local">åœ°æ–¹éƒ½å¸‚/ãƒªãƒ¢ãƒ¼ãƒˆ</option>
                </select>
                <button class="back-button" onclick="prevStep(5)">æˆ»ã‚‹</button>
                <button onclick="nextStep(7)">æ¬¡ã¸</button>
            </div>
            
            <div id="q7" class="question hidden">
                <label for="remoteRatio">Q7: ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã®å‰²åˆã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</label>
                <select id="remoteRatio">
                    <option value="fullRemote">ãƒ•ãƒ«ãƒªãƒ¢ãƒ¼ãƒˆ</option>
                    <option value="hybrid">ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ï¼ˆé€±2ã€œ3å›å‡ºç¤¾ï¼‰</option>
                    <option value="onSite">å¸¸é§ï¼ˆãƒ•ãƒ«å‡ºç¤¾ï¼‰</option>
                </select>
                <button class="back-button" onclick="prevStep(6)">æˆ»ã‚‹</button>
                <button onclick="nextStep(8)">æ¬¡ã¸</button>
            </div>

            <div id="q8" class="question hidden">
                <label for="notes">Q8: ãã®ä»–ã€ç‰¹è¨˜äº‹é …ãŒã‚ã‚Œã°è¨˜å…¥ã—ã¦ãã ã•ã„ï¼ˆä»»æ„ï¼‰ã€‚</label>
                <textarea id="notes" rows="3"></textarea>
                <button class="back-button" onclick="prevStep(7)">æˆ»ã‚‹</button>
                <button onclick="calculate()">çµæœã‚’è¨ˆç®—</button>
            </div>

        </div>

        <div id="results" class="hidden">
            <h2>å˜ä¾¡è¨ºæ–­çµæœ</h2>
            <p>ãŠå®¢æ§˜ã®å˜ä¾¡: <span id="displayPrice"></span> å†† (ç¨æŠœ)</p>
            <p><strong>è¨ºæ–­çµæœã«åŸºã¥ã„ãŸæ¨å¥¨å˜ä¾¡ï¼ˆèª¿æ•´å¾Œï¼‰:</strong> <span id="recommendedPrice"></span> å†† (ç¨æŠœ)</p>
            <p><strong>èª¿æ•´ç‡:</strong> <span id="adjustmentRate"></span></p>
            
            <div id="feedback"></div>

            <div id="rate-check" class="error hidden">
                ğŸš¨ **å˜ä¾¡ãƒã‚§ãƒƒã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆ**ï¼šãŠå®¢æ§˜å˜ä¾¡ãŒæ¨å¥¨å˜ä¾¡ã®<span id="rate-difference"></span>%ä»¥ä¸Šä½ã„ã§ã™ã€‚å–¶æ¥­ã«ã”ç›¸è«‡ãã ã•ã„ã€‚
            </div>

            <button onclick="sendToSlack()">Slackã«çµæœã‚’å…±æœ‰</button>

            <button class="back-button" onclick="resetApp()">æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™</button>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 8;
        const questions = [];
        for(let i=1; i<=totalSteps; i++) {
            questions.push(document.getElementById('q' + i));
        }

        function showStep(step) {
            questions.forEach(q => q.classList.add('hidden'));
            document.getElementById('q' + step).classList.remove('hidden');
            currentStep = step;
        }

        function nextStep(next) {
            // Q1 (åŸºæœ¬å˜ä¾¡) ã®å…¥åŠ›ãƒã‚§ãƒƒã‚¯
            if (currentStep === 1) {
                const price = document.getElementById('price').value;
                if (!price || price <= 0) {
                    alert("å˜ä¾¡ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
                    return;
                }
            }
            showStep(next);
        }

        function prevStep(prev) {
            showStep(prev);
        }

        function calculate() {
            const price = parseFloat(document.getElementById('price').value);
            const contractType = document.getElementById('contractType').value;
            const workingHours = document.getElementById('workingHours').value;
            const experience = document.getElementById('experience').value;
            const skillLevel = document.getElementById('skillLevel').value;
            const location = document.getElementById('location').value;
            const remoteRatio = document.getElementById('remoteRatio').value;

            // åˆæœŸèª¿æ•´ç‡ã‚’1.0ï¼ˆå¤‰å‹•ãªã—ï¼‰ã«è¨­å®š
            let adjustmentRate = 1.0;

            // 1. å¥‘ç´„å½¢æ…‹ã«ã‚ˆã‚‹èª¿æ•´
            if (contractType === 'freelance') {
                adjustmentRate += 0.05; // æ¥­å‹™å§”è¨—ã¯+5%
            } else if (contractType === 'employee') {
                adjustmentRate -= 0.03; // æ­£ç¤¾å“¡ï¼ˆæ´¾é£ï¼‰ã¯-3%
            }

            // 2. ç¨¼åƒæ™‚é–“ã«ã‚ˆã‚‹èª¿æ•´
            if (workingHours === 'short') {
                adjustmentRate -= 0.10; // çŸ­æ™‚é–“ç¨¼åƒã¯-10%
            } else if (workingHours === 'long') {
                adjustmentRate += 0.08; // é•·æ™‚é–“ç¨¼åƒã¯+8%
            }

            // 3. çµŒé¨“å¹´æ•°ã«ã‚ˆã‚‹èª¿æ•´
            if (experience === 'junior') {
                adjustmentRate -= 0.15; // çµŒé¨“å¹´æ•°1å¹´æœªæº€ã¯-15%
            } else if (experience === 'senior') {
                adjustmentRate += 0.12; // çµŒé¨“å¹´æ•°3å¹´ä»¥ä¸Šã¯+12%
            }

            // 4. ã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«ã«ã‚ˆã‚‹èª¿æ•´
            if (skillLevel === 'advanced') {
                adjustmentRate += 0.10; // å°‚é–€æ€§ã¯+10%
            } else if (skillLevel === 'lead') {
                adjustmentRate += 0.15; // ãƒªãƒ¼ãƒ‰/è¨­è¨ˆèƒ½åŠ›ã¯+15%
            }
            
            // 5. å‹¤å‹™åœ°ã«ã‚ˆã‚‹èª¿æ•´
            if (location === 'tokyo') {
                adjustmentRate += 0.05; // æ±äº¬éƒ½å¿ƒéƒ¨ã¯+5%
            }

            // 6. ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã®å‰²åˆã«ã‚ˆã‚‹èª¿æ•´
            if (remoteRatio === 'fullRemote') {
                adjustmentRate -= 0.05; // ãƒ•ãƒ«ãƒªãƒ¢ãƒ¼ãƒˆã¯-5%
            } else if (remoteRatio === 'onSite') {
                adjustmentRate += 0.05; // å¸¸é§ã¯+5%
            }


            // èª¿æ•´å¾Œã®æ¨å¥¨å˜ä¾¡ã‚’è¨ˆç®— (100å††å˜ä½ã§ä¸¸ã‚ã‚‹)
            let recommendedPrice = Math.round((price * adjustmentRate) / 100) * 100;
            
            // èª¿æ•´ç‡ã®è¡¨ç¤º
            const rateDisplay = (adjustmentRate * 100).toFixed(0) + "%";


            // çµæœè¡¨ç¤º
            document.getElementById('displayPrice').textContent = price.toLocaleString();
            document.getElementById('recommendedPrice').textContent = recommendedPrice.toLocaleString();
            document.getElementById('adjustmentRate').textContent = rateDisplay;

            // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆç°¡ç•¥åŒ–ï¼‰
            document.getElementById('feedback').innerHTML = `
                <p>ç¾åœ¨ã®å¸‚å ´ä¾¡å€¤ã¨æ¡ˆä»¶ã®ç‰¹æ€§ã«åŸºã¥ã„ã¦å˜ä¾¡ã‚’è©•ä¾¡ã—ã¾ã—ãŸã€‚</p>
                <p>æ¨å¥¨å˜ä¾¡ã¯ã€åŸºæœ¬å˜ä¾¡ã‹ã‚‰ç´„ ${(adjustmentRate - 1.0) * 100}% ã®èª¿æ•´ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚</p>
            `;
            
            // å¿…é ˆæ©Ÿèƒ½: Q8 å˜ä¾¡ãƒã‚§ãƒƒã‚¯ã‚¢ãƒ©ãƒ¼ãƒˆ
            const rateDifferenceElement = document.getElementById('rate-check');
            const difference = recommendedPrice - price;
            const differencePercentage = ((difference / recommendedPrice) * 100).toFixed(0);

            // æ¨å¥¨å˜ä¾¡ã‚ˆã‚Š5%ä»¥ä¸Šä½ã„å ´åˆã«ã‚¢ãƒ©ãƒ¼ãƒˆ
            if (differencePercentage < -5) { 
                document.getElementById('rate-difference').textContent = Math.abs(differencePercentage);
                rateDifferenceElement.classList.remove('hidden');
            } else {
                rateDifferenceElement.classList.add('hidden');
            }


            // çµæœç”»é¢ã‚’è¡¨ç¤º
            document.getElementById('quiz-area').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');
        }

        // å¿…é ˆæ©Ÿèƒ½: Slacké€£æº
        function sendToSlack() {
            const price = parseFloat(document.getElementById('price').value).toLocaleString();
            const recommendedPrice = document.getElementById('recommendedPrice').textContent;
            const adjustmentRate = document.getElementById('adjustmentRate').textContent;
            const notes = document.getElementById('notes').value || "ç‰¹ã«ãªã—";

            const slackMessage = `
            ---å˜ä¾¡è¨ºæ–­çµæœ---
            *ãŠå®¢æ§˜å˜ä¾¡*: ${price}å††
            *æ¨å¥¨èª¿æ•´å˜ä¾¡*: ${recommendedPrice}å††
            *èª¿æ•´ç‡*: ${adjustmentRate}
            *Q8ç‰¹è¨˜äº‹é …*: ${notes}

            æ¡ˆä»¶ã®è©³ç´°ã¨å¸‚å ´ä¾¡å€¤ã‚’è€ƒæ…®ã—ãŸçµæœã§ã™ã€‚
            `;
            
            // Slackã®æŠ•ç¨¿ç”¨URLã‚¹ã‚­ãƒ¼ãƒ ï¼ˆãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã‚„ã™ã„ï¼‰
            const slackUrl = `slack://post?message=${encodeURIComponent(slackMessage)}`;
            
            // ãƒ–ãƒ©ã‚¦ã‚¶ã§Slackã‚¢ãƒ—ãƒªã‚’èµ·å‹•
            window.location.href = slackUrl;

            alert("Slackã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã¾ã™ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã”ç¢ºèªãã ã•ã„ã€‚");
        }

        // å¿…é ˆæ©Ÿèƒ½: æœ€åˆã«æˆ»ã‚‹ãƒœã‚¿ãƒ³
        function resetApp() {
            // å…¥åŠ›å€¤ã®ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('price').value = '';
            document.getElementById('contractType').value = 'freelance';
            document.getElementById('workingHours').value = 'standard';
            document.getElementById('experience').value = 'junior';
            document.getElementById('skillLevel').value = 'basic';
            document.getElementById('location').value = 'tokyo';
            document.getElementById('remoteRatio').value = 'fullRemote';
            document.getElementById('notes').value = '';
            
            // çµæœã¨ã‚¢ãƒ©ãƒ¼ãƒˆã‚’éè¡¨ç¤º
            document.getElementById('results').classList.add('hidden');
            document.getElementById('rate-check').classList.add('hidden');

            // æœ€åˆã®è³ªå•ã«æˆ»ã‚‹
            showStep(1);
            document.getElementById('quiz-area').classList.remove('hidden');
        }

        // åˆæœŸè¡¨ç¤º
        showStep(1);
    </script>
</body>
</html>